!function(a,b,c,d){function e(a){if(a){var b=top.location.search.replace(/^\?/,"").split("&");for(var c in b){var d=b[c],e=d.match(/([^=]*)=(\w*)/);if(e[1]===a)return decodeURIComponent(e[2])}}return!1}function k(a,c){var d=b.socialButtonCountObjects[a];c>0&&d.setCountValue(c),delete b.socialButtonCountObjects[a]}var f=function(b){return b?a.extend(!0,f.defaults,b):f.defaults};f.defaults={selectors:{facebookButton:".l-fb",twitterButton:".l-tw",vkontakteButton:".l-vk",odnoklassnikiButton:".l-ok",gplusButton:".l-gp",count:".l-count",ico:".l-ico",shareTitle:"h2:eq(0)",shareSumary:"p:eq(0)",shareImages:"img[src]"},buttonDepth:2,alternativeImage:"",alternativeSummary:"",alternativeTitle:"",forceAlternativeImage:!1,forceAlternativeSummary:!1,forceAlternativeTitle:!1,classes:{countVisibleClass:"like-not-empty"},keys:{shareLinkParam:"href"},popupWindowOptions:["left=0","top=0","width=500","height=250","personalbar=0","toolbar=0","scrollbars=1","resizable=1"]};var g=function(){};g.lastIndex=0,g.prototype={init:function(b,c,d){this.config=c,this.index=d,this.$context=b,this.$count=a(this.config.selectors.count,this.$context),this.$ico=a(this.config.selectors.ico,this.$context),this.collectShareInfo(),this.bindEvents(),this.ajaxRequest=this.countLikes()},bindEvents:function(){this.$context.bind("click",g.returnFalse),this.$ico.bind("click",this,this.openShareWindow)},setCountValue:function(a){this.$context.addClass(this.config.classes.countVisibleClass),this.$count.text(a)},getCountLink:function(a){return this.countServiceUrl+encodeURIComponent(a)},collectShareInfo:function(){for(var e=this.$context,f=this,g=0;g<this.config.buttonDepth;g++)e=e.parent();var h=this.$context.attr(this.config.keys.shareLinkParam),i=pathbs;this.linkhref=b.location.href.replace(b.location.pathname+b.location.search,"")+h,this.linkToShare=h,h?h.indexOf("http://")==-1&h.indexOf("https://")==-1&&(this.linkToShare="/"==h[0]?i+h:b.location.origin+b.location.pathname+h):h=b.location.origin+b.location.pathname;var j=a(this.config.selectors.shareTitle,e),k=a(this.config.selectors.shareSumary,e),l=a(this.config.selectors.shareImages,e);this.title=j.text(),this.config.forceAlternativeTitle?this.title=this.config.alternativeTitle:0==j.length&&this.config.alternativeTitle?this.title=this.config.alternativeTitle:this.title=c.title,k.length>0&!this.config.forceAlternativeSummary?this.summary=k.text():this.summary=this.config.alternativeSummary?this.config.alternativeSummary:d,this.images=[],l.length>0&!this.config.forceAlternativeImage?l.each(function(a,b){f.images[a]=b.src}):this.images[0]=this.config.alternativeImage?this.config.alternativeImage:d},getPopupOptions:function(){return this.config.popupWindowOptions.join(",")},openShareWindow:function(a){var c=a.data,d=c.getShareLink(),e=c.getPopupOptions(),f=b.open(d,"",e);b.focus&&f.focus()},linkToShare:null,title:c.title,summary:null,images:[],countServiceUrl:null,$context:null,$count:null,$ico:null},g=a.extend(g,{returnFalse:function(a){return!1}});var h=function(a,b,c){this.init(a,b,c),this.type="facebook"};h.prototype=new g,h.prototype=a.extend(h.prototype,{countLikes:function(){var b=this.getCountLink(this.linkToShare),c=this;return a.ajax({url:b,dataType:"jsonp",success:function(a,b,d){"success"==b&&a[0]&&a[0].share_count>0&&c.setCountValue(a[0].share_count)}})},getCountLink:function(a){var b='SELECT share_count FROM link_stat WHERE url="'+a+'"';return this.countServiceUrl+encodeURIComponent(b)},getShareLink:function(){var a="";for(var b in this.images)a+="&p[images]["+b+"]="+encodeURIComponent(this.images[b]);return"http://www.facebook.com/sharer/sharer.php?s=100&p[url]="+encodeURIComponent(this.linkToShare)+(this.summary?"&p[summary]="+encodeURIComponent(this.summary):"")+"&p[title]="+encodeURIComponent(this.title)+(a?a:"")},countServiceUrl:"https://api.facebook.com/method/fql.query?format=json&query="});var i=function(a,b,c){this.init(a,b,c),this.type="twitter"};i.prototype=new g,i.prototype=a.extend(i.prototype,{countLikes:function(){var b=this.getCountLink(this.linkToShare),c=this;return a.ajax({url:b,dataType:"jsonp",success:function(a,b,d){"success"==b&a.count>0&&c.setCountValue(a.count)}})},getShareLink:function(){return"https://twitter.com/share?url="+encodeURIComponent(this.linkToShare)+(this.title?"&text="+encodeURIComponent(this.title):"")},countServiceUrl:"http://urls.api.twitter.com/1/urls/count.json?url="});var j=function(a,b,c){this.init(a,b,c),this.type="vkontakte"};if(j.prototype=new g,j.prototype=a.extend(j.prototype,{countLikes:function(){var c=this.getCountLink(this.linkToShare)+"&index="+this.index;return b.socialButtonCountObjects[this.index]=this,a.ajax({url:c,dataType:"jsonp"})},getShareLink:function(){return"http://vkontakte.ru/share.php?url="+encodeURIComponent(this.linkToShare)+(this.summary?"&description="+encodeURIComponent(this.summary):"")+"&title="+encodeURIComponent(this.title)+"&image="+encodeURIComponent(this.images[0])},countServiceUrl:"http://vkontakte.ru/share.php?act=count&url="}),b.socialButtonCountObjects={},b.VK){var l=b.VK.Share.count;b.VK.Share.count=function(a,c){k(a,c),l.call(b.VK.Share,a,c)}}else b.VK={Share:{count:function(a,b){k(a,b)}}};var m=function(a,b,c){this.init(a,b,c),this.type="odnoklassniki"};m.prototype=new g,m.prototype=a.extend(m.prototype,{countLikes:function(){var b="http://www.odnoklassniki.ru/dk?st.cmd=extOneClickLike&uid=odklocs0&ref="+encodeURIComponent(this.linkhref);return execOd=this,a.post("plugins/content/jllike/models/ajax.php",{curl:b,variant:"od"},function(a){0!=a&&execOd.setCountValue(a)})},getShareLink:function(){return"http://www.odnoklassniki.ru/dk?st.cmd=addShare&st._surl="+encodeURIComponent(this.linkhref)},countServiceUrl:"http://www.odnoklassniki.ru/dk?st.cmd=extOneClickLike&uid=odklocs0&ref="+this.linkhref});var n=function(a,b,c){this.init(a,b,c),this.type="gplusButton"};n.prototype=new g,n.prototype=a.extend(n.prototype,{countLikes:function(){return serviceURI="https://plusone.google.com/_/+1/fastbutton?url="+encodeURIComponent(this.linkhref),execGP=this,a.post("plugins/content/jllike/models/ajax.php",{curl:serviceURI,variant:"gp"},function(a){0!=a&&execGP.setCountValue(a)})},getShareLink:function(){return"https://plus.google.com/share?url="+encodeURIComponent(this.linkhref)},countServiceUrl:"https://plusone.google.com/_/+1/fastbutton?url="}),a.fn.socialButton=function(b){return this.each(function(c,d){setTimeout(function(){var c=a(d),e=new f(b),k=!1;g.lastIndex++,c.is(e.selectors.facebookButton)?k=new h(c,e,g.lastIndex):c.is(e.selectors.twitterButton)?k=new i(c,e,g.lastIndex):c.is(e.selectors.vkontakteButton)?k=new j(c,e,g.lastIndex):c.is(e.selectors.odnoklassnikiButton)?k=new m(c,e,g.lastIndex):c.is(e.selectors.gplusButton)&&(k=new n(c,e,g.lastIndex)),a.when(k.ajaxRequest).then(function(){c.trigger("socialButton.done",[k.type])},function(){c.trigger("socialButton.done",[k.type])})},0)}),this},a.scrollToButton=function(c,d){if(!b.location.hash&&b.location.search){var f=e(c);if(f){var g=a("#"+f);g.length>0&&a("html,body").animate({scrollTop:g.offset().top,scrollLeft:g.offset().left},d||1e3)}}return this}}(jQuery,window,document);